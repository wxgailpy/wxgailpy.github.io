"use strict";(self.webpackChunkjira=self.webpackChunkjira||[]).push([[279],{3279:function(n,e,t){t.r(e),t.d(e,{default:function(){return ke}});var r=t(168),i=t(2791),o=t(9439),a=t(1413),u=t(6470),s=t(5386),c=t(286),l=t(1933),d=function(n){var e=(0,c.i)();return(0,l.useQuery)(["users",n],(function(){return e("users",{data:n})}))},f=t(4925),p=t(3734),x=t(184),m=["value","options","defaultOptionName","onChange"];function h(n){var e=n.value,t=n.options,r=n.defaultOptionName,i=n.onChange,o=(0,f.Z)(n,m);return(0,x.jsxs)(p.Z,(0,a.Z)((0,a.Z)({value:null!==t&&void 0!==t&&t.length?j(e):0,onChange:function(n){return null===i||void 0===i?void 0:i(j(n)||void 0)}},o),{},{children:[r?(0,x.jsx)(p.Z.Option,{value:0,children:r}):null,null===t||void 0===t?void 0:t.map((function(n){return(0,x.jsx)(p.Z.Option,{value:n.id,children:n.name},n.id)}))]}))}var j=function(n){return isNaN(Number(n))?0:Number(n)};function v(n){var e=d().data;return e?(0,x.jsx)(h,(0,a.Z)({options:e||[]},n)):null}function Z(n){var e=n.setParam,t=n.param;return(0,x.jsxs)(u.Z,{style:{marginBottom:"2rem"},layout:"inline",children:[(0,x.jsx)(u.Z.Item,{children:(0,x.jsx)(s.Z,{placeholder:"\u9879\u76ee\u540d",type:"text",value:t.name,onChange:function(n){return e((0,a.Z)((0,a.Z)({},t),{},{name:n.target.value}))}})}),(0,x.jsx)(u.Z.Item,{children:(0,x.jsx)(v,{defaultOptionName:"\u8d1f\u8d23\u4eba",value:t.personId,onChange:function(n){return e((0,a.Z)((0,a.Z)({},t),{},{personId:n}))}})})]})}var C=t(6896),g=t(6574),L=t(7382),y=t(6090),k=t(7892),b=t.n(k),I=t(1087),w=t(7561),M=["checked","onCheckedChange"];function T(n){var e=n.checked,t=n.onCheckedChange,r=(0,f.Z)(n,M);return(0,x.jsx)(w.Z,(0,a.Z)({count:1,value:e?1:0,onChange:function(n){return null===t||void 0===t?void 0:t(!!n)}},r))}var E=t(3433),O=t(4165),P=t(5861),F=function(n,e){var t=(0,l.useQueryClient)();return{onSuccess:function(){return t.invalidateQueries(n)},onMutate:function(r){return(0,P.Z)((0,O.Z)().mark((function i(){var o;return(0,O.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=t.getQueryData(n),t.setQueryData(n,(function(n){return e(r,n)})),i.abrupt("return",{previousItems:o});case 3:case"end":return i.stop()}}),i)})))()},onError:function(e,r,i){t.setQueryData(n,i.previousItems)}}},N=function(n){return F(n,(function(n,e){return(null===e||void 0===e?void 0:e.filter((function(e){return e.id!==n.id})))||[]}))},z=function(n){return F(n,(function(n,e){return(null===e||void 0===e?void 0:e.map((function(e){return e.id===n.id?(0,a.Z)((0,a.Z)({},e),n):e})))||[]}))},A=function(n){return F(n,(function(n,e){return e?[].concat((0,E.Z)(e),[n]):[]}))},S=t(5850),D=function(n){var e=(0,c.i)();return(0,l.useQuery)(["projects",(0,S.Ti)(n)],(function(){return e("projects",{data:n})}))},Q=function(n){var e=(0,c.i)();return(0,l.useMutation)((function(n){return e("projects/".concat(n.id),{data:n,method:"PATCH"})}),z(n))},Y=function(n){var e=(0,c.i)();return(0,l.useMutation)((function(n){return e("projects",{data:n,method:"POST"})}),A(n))},R=function(n){var e=(0,c.i)();return(0,l.useQuery)(["project",{id:n}],(function(){return e("projects/".concat(n))}),{enabled:Boolean(n)})},X=t(5728),B=t(4942),W=function(n){var e=(0,I.lr)(),t=(0,o.Z)(e,1)[0],r=q();return[(0,i.useMemo)((function(){return n.reduce((function(n,e){return(0,a.Z)((0,a.Z)({},n),{},(0,B.Z)({},e,t.get(e)||""))}),{})}),[t]),function(n){return r(n)}]},q=function(){var n=(0,I.lr)(),e=(0,o.Z)(n,2),t=e[0],r=e[1];return function(n){var e=(0,S.Ti)((0,a.Z)((0,a.Z)({},Object.fromEntries(t)),n));return r(e)}},H=function(){var n=W(["name","personId"]),e=(0,o.Z)(n,2),t=e[0],r=e[1];return[(0,i.useMemo)((function(){return(0,a.Z)((0,a.Z)({},t),{},{personId:Number(t.personId)||void 0})}),[t]),r]},V=function(){var n=H();return["projects",(0,o.Z)(n,1)[0]]},K=function(){var n=W(["projectCreate"]),e=(0,o.Z)(n,2),t=e[0].projectCreate,r=e[1],i=W(["editingProjectId"]),a=(0,o.Z)(i,2),u=a[0].editingProjectId,s=a[1],c=R(Number(u)),l=c.data,d=c.isLoading,f=q();return{projectModalOpen:"true"===t||!!u,open:function(){return r({projectCreate:!0})},close:function(){return f({projectCreate:"",editingProjectId:""})},startEdit:function(n){return s({editingProjectId:n})},editingProject:l,isLoading:d}},G=["users"];function U(n){var e=n.users,t=(0,f.Z)(n,G),r=Q(V()).mutate;return(0,x.jsx)(C.Z,(0,a.Z)({rowKey:function(n){return n.id},columns:[{title:(0,x.jsx)(T,{checked:!0,disabled:!0}),render:function(n,e){return(0,x.jsx)(T,{checked:e.pin,onCheckedChange:(t=e.id,function(n){return r({id:t,pin:n})})});var t}},{title:"\u540d\u79f0",sorter:function(n,e){return n.name.localeCompare(e.name)},render:function(n,e){return(0,x.jsx)(I.rU,{to:String(e.id),children:e.name})}},{title:"\u90e8\u95e8",dataIndex:"organization"},{title:"\u8d1f\u8d23\u4eba",dataIndex:"personId",render:function(n,t){var r;return(0,x.jsx)("span",{children:(null===(r=e.find((function(n){return n.id===t.personId})))||void 0===r?void 0:r.name)||"\u672a\u77e5"},t.id+"-"+t.personId)}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"created",render:function(n,e){return(0,x.jsx)("span",{children:e.created?b()(e.created).format("YYYY-MM-DD"):"\u65e0"})}},{render:function(n,e){return(0,x.jsx)(J,{project:e})}}],pagination:!1},t))}var _,J=function(n){var e=n.project,t=K().startEdit,r=function(n){var e=(0,c.i)();return(0,l.useMutation)((function(n){var t=n.id;return e("projects/".concat(t),{method:"DELETE"})}),N(n))}(V()).mutate;return(0,x.jsx)(L.Z,{overlay:(0,x.jsx)(y.Z,{style:{color:"#0052cc"},items:[{key:"edit",label:"\u7f16\u8f91",onClick:function(){var n;n=e.id,t(n)}},{key:"delete",label:"\u5220\u9664",onClick:function(){var n;n=e.id,g.Z.confirm({title:"\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u4e2a\u9879\u76ee\u5417?",content:"\u70b9\u51fb\u786e\u5b9a\u5220\u9664",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){r({id:n})}})}}]}),children:(0,x.jsx)(X.zL,{type:"link",children:"..."})})},$=t(3299),nn=t(7309);function en(){(0,S.jr)("\u9879\u76ee\u5217\u8868",!1);var n=H(),e=(0,o.Z)(n,2),t=e[0],r=e[1],i=D((0,S.Nr)(t,200)),a=i.isLoading,u=i.error,s=i.data,c=d().data,l=K().open;return(0,x.jsxs)(on,{children:[(0,x.jsxs)(X.X2,{between:!0,children:[(0,x.jsx)("h1",{children:"\u9879\u76ee\u5217\u8868 "}),(0,x.jsx)(nn.Z,{onClick:l,children:"\u521b\u5efa\u9879\u76ee"})]}),(0,x.jsx)(Z,{param:t,setParam:r,users:c||[]}),(0,x.jsx)(X.Tv,{error:u}),(0,x.jsx)(U,{loading:a,dataSource:s||[],users:c||[]})]})}var tn,rn,on=$.Z.div(_||(_=(0,r.Z)(["\n  padding: 3.2rem;\n  flex: 1;\n"]))),an=t(9042),un=["title","titleId"];function sn(){return sn=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},sn.apply(this,arguments)}function cn(n,e){if(null==n)return{};var t,r,i=function(n,e){if(null==n)return{};var t,r,i={},o=Object.keys(n);for(r=0;r<o.length;r++)t=o[r],e.indexOf(t)>=0||(i[t]=n[t]);return i}(n,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(r=0;r<o.length;r++)t=o[r],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}function ln(n,e){var t=n.title,r=n.titleId,o=cn(n,un);return i.createElement("svg",sn({viewBox:"0 0 179 32",xmlns:"http://www.w3.org/2000/svg",focusable:"false","aria-hidden":"true",className:"css-sq9aeg-Logo",ref:e,"aria-labelledby":r},o),t?i.createElement("title",{id:r},t):null,tn||(tn=i.createElement("defs",null,i.createElement("linearGradient",{x1:"97.6553341%",y1:"35.6591143%",x2:"37.202032%",y2:"75.4891864%",id:"uid392-1"},i.createElement("stop",{stopColor:"#0052CC",offset:"7%"}),i.createElement("stop",{stopColor:"#2684FF",offset:"100%"})),i.createElement("linearGradient",{x1:"8.43371138%",y1:"60.1495759%",x2:"64.1161517%",y2:"23.5790285%",id:"uid392-2"},i.createElement("stop",{stopColor:"#0052CC",offset:"0%"}),i.createElement("stop",{stopColor:"#2684FF",offset:"100%"})))),rn||(rn=i.createElement("g",{stroke:"none",strokeWidth:1,fillRule:"nonzero"},i.createElement("path",{d:"M11.3881081,27.9242105 C12.4881804,26.8071817 13.1062496,25.2917664 13.1062496,23.7115789 C13.1062496,22.1313915 12.4881804,20.6159762 11.3881081,19.4989474 L11.3881081,19.4989474 L3.74837838,11.7621053 L0.273513514,15.2926316 C-0.0900771727,15.6625064 -0.0900771727,16.2617042 0.273513514,16.6315789 L11.3881081,27.9242105 L11.3881081,27.9242105 Z",fill:"currentColor",fillRule:"nonzero"}),i.createElement("path",{d:"M22.5027027,15.2926316 L11.3881081,4 L11.3881081,4 L11.3539189,4.03473684 L11.3539189,4.03473684 C9.08852466,6.36456187 9.09963243,10.1156459 11.3787838,12.4315789 L19.0247297,20.1652632 L22.5027027,16.6315789 C22.8662934,16.2617042 22.8662934,15.6625064 22.5027027,15.2926316 Z",fill:"currentColor",fillRule:"nonzero"}),i.createElement("path",{d:"M11.3881081,12.4252632 C9.10895676,10.1093301 9.09784899,6.35824608 11.3632432,4.02842105 L3.43445946,12.0810526 L7.58067568,16.2936842 L11.3881081,12.4252632 Z",fill:"url(#uid392-1)",fillRule:"nonzero"}),i.createElement("path",{d:"M15.1893243,15.6368421 L11.3881081,19.4989474 C12.4881804,20.6159762 13.1062496,22.1313915 13.1062496,23.7115789 C13.1062496,25.2917664 12.4881804,26.8071817 11.3881081,27.9242105 L19.3355405,19.8494737 L15.1893243,15.6368421 Z",fill:"url(#uid392-2)",fillRule:"nonzero"}),i.createElement("path",{d:"M36.07,18.956 C36.07,20.646 35.394,21.842 33.418,21.842 C32.56,21.842 31.702,21.686 31,21.4 L31,23.662 C31.65,23.896 32.586,24.104 33.808,24.104 C37.032,24.104 38.41,21.946 38.41,18.8 L38.41,6.918 L36.07,6.918 L36.07,18.956 Z M41.894,7.568 C41.894,8.556 42.544,9.128 43.454,9.128 C44.364,9.128 45.014,8.556 45.014,7.568 C45.014,6.58 44.364,6.008 43.454,6.008 C42.544,6.008 41.894,6.58 41.894,7.568 Z M42.31,24 L44.546,24 L44.546,11 L42.31,11 L42.31,24 Z M47.926,24 L50.11,24 L50.11,16.33 C50.11,13.574 51.852,12.716 54.712,13.002 L54.712,10.818 C52.164,10.662 50.864,11.754 50.11,13.288 L50.11,11 L47.926,11 L47.926,24 Z M65.45,24 L65.45,21.66 C64.618,23.376 63.058,24.26 61.056,24.26 C57.598,24.26 55.856,21.322 55.856,17.5 C55.856,13.834 57.676,10.74 61.316,10.74 C63.214,10.74 64.67,11.598 65.45,13.288 L65.45,11 L67.686,11 L67.686,24 L65.45,24 Z M58.092,17.5 C58.092,20.62 59.34,22.18 61.654,22.18 C63.656,22.18 65.45,20.906 65.45,18.02 L65.45,16.98 C65.45,14.094 63.812,12.82 61.914,12.82 C59.392,12.82 58.092,14.484 58.092,17.5 Z M86.926,19.294 C86.926,16.226 84.898,15.056 81.284,14.146 C78.268,13.392 77.176,12.69 77.176,11.286 C77.176,9.726 78.502,8.946 80.738,8.946 C82.506,8.946 84.352,9.258 86.068,10.246 L86.068,7.906 C84.898,7.256 83.312,6.658 80.842,6.658 C76.864,6.658 74.836,8.634 74.836,11.286 C74.836,14.094 76.552,15.42 80.4,16.356 C83.65,17.136 84.586,17.942 84.586,19.45 C84.586,20.958 83.624,21.972 81.05,21.972 C78.788,21.972 76.344,21.374 74.758,20.542 L74.758,22.934 C76.084,23.61 77.618,24.26 80.92,24.26 C85.158,24.26 86.926,22.258 86.926,19.294 Z M95.09,24.26 C91.19,24.26 88.902,21.374 88.902,17.474 C88.902,13.574 91.19,10.74 95.09,10.74 C98.964,10.74 101.226,13.574 101.226,17.474 C101.226,21.374 98.964,24.26 95.09,24.26 Z M95.09,12.82 C92.308,12.82 91.086,15.004 91.086,17.474 C91.086,19.944 92.308,22.18 95.09,22.18 C97.846,22.18 99.042,19.944 99.042,17.474 C99.042,15.004 97.846,12.82 95.09,12.82 Z M106.92,9.622 C106.92,8.452 107.596,7.646 108.974,7.646 C109.494,7.646 109.988,7.698 110.378,7.776 L110.378,5.722 C109.988,5.618 109.546,5.514 108.87,5.514 C106.088,5.514 104.736,7.152 104.736,9.57 L104.736,11 L102.63,11 L102.63,13.08 L104.736,13.08 L104.736,24 L106.92,24 L106.92,13.08 L110.274,13.08 L110.274,11 L106.92,11 L106.92,9.622 Z M115.786,19.892 L115.786,13.08 L119.244,13.08 L119.244,11 L115.786,11 L115.786,8.244 L113.602,8.244 L113.602,11 L111.496,11 L111.496,13.08 L113.602,13.08 L113.602,19.944 C113.602,22.362 114.954,24 117.736,24 C118.412,24 118.854,23.896 119.244,23.792 L119.244,21.634 C118.854,21.712 118.36,21.816 117.84,21.816 C116.462,21.816 115.786,21.036 115.786,19.892 Z M125.432,24 L128.292,24 L130.528,17.708 L131.724,13.704 L132.92,17.708 L135.156,24 L138.016,24 L142.8,11 L140.33,11 L136.586,22.024 L132.79,11 L130.658,11 L126.862,22.024 L123.118,11 L120.648,11 L125.432,24 Z M153.538,24 L153.538,21.66 C152.706,23.376 151.146,24.26 149.144,24.26 C145.686,24.26 143.944,21.322 143.944,17.5 C143.944,13.834 145.764,10.74 149.404,10.74 C151.302,10.74 152.758,11.598 153.538,13.288 L153.538,11 L155.774,11 L155.774,24 L153.538,24 Z M146.18,17.5 C146.18,20.62 147.428,22.18 149.742,22.18 C151.744,22.18 153.538,20.906 153.538,18.02 L153.538,16.98 C153.538,14.094 151.9,12.82 150.002,12.82 C147.48,12.82 146.18,14.484 146.18,17.5 Z M159.154,24 L161.338,24 L161.338,16.33 C161.338,13.574 163.08,12.716 165.94,13.002 L165.94,10.818 C163.392,10.662 162.092,11.754 161.338,13.288 L161.338,11 L159.154,11 L159.154,24 Z M178.108,23.48 C177.042,24.052 175.404,24.26 174.078,24.26 C169.216,24.26 167.084,21.452 167.084,17.474 C167.084,13.548 169.268,10.74 173.22,10.74 C177.224,10.74 178.836,13.522 178.836,17.474 L178.836,18.488 L169.346,18.488 C169.658,20.698 171.088,22.128 174.156,22.128 C175.664,22.128 176.938,21.842 178.108,21.426 L178.108,23.48 Z M173.116,12.768 C170.75,12.768 169.554,14.302 169.32,16.564 L176.574,16.564 C176.444,14.146 175.352,12.768 173.116,12.768 Z",fill:"inherit",fillRule:"evenodd"}))))}var dn=i.forwardRef(ln),fn=(t.p,t(7689)),pn=function(n){var e=(0,c.i)();return(0,l.useQuery)(["tasks",n],(function(){return e("tasks",{data:n})}))},xn=function(){var n,e=null===(n=(0,fn.TH)().pathname.match(/projects\/(\d+)/))||void 0===n?void 0:n[1];return Number(e)},mn=function(){return R(xn())},hn=function(){return{projectId:xn()}},jn=function(){return["kanbans",hn()]},vn=function(){var n=W(["name","typeId","processorId","tagId"]),e=(0,o.Z)(n,1)[0],t=xn();return(0,i.useMemo)((function(){return{projectId:t,typeId:Number(e.typeId)||void 0,processorId:Number(e.processorId)||void 0,tagId:Number(e.tagId)||void 0,name:e.name}}),[t,e])},Zn=function(){return["tasks",vn()]},Cn=function(){var n=W(["editingTaskId"]),e=(0,o.Z)(n,2),t=e[0].editingTaskId,r=e[1],a=function(n){var e=(0,c.i)();return(0,l.useQuery)(["task",{id:n}],(function(){return e("tasks/".concat(n))}),{enabled:Boolean(n)})}(Number(t)),u=a.data,s=a.isLoading;return{editingTaskId:t,editingTask:u,startEdit:(0,i.useCallback)((function(n){r({editingTaskId:n})}),[r]),close:(0,i.useCallback)((function(){r({editingTaskId:""})}),[r]),isLoading:s}},gn=function(){var n=(0,c.i)();return(0,l.useQuery)(["taskTypes"],(function(){return n("taskTypes")}))};var Ln=t.p+"static/media/task.ecbb2adc0c5b3b6a6bcb93d22518b211.svg";var yn,kn,bn=t.p+"static/media/bug.52d5334dcb7664138acb7baaf4af220c.svg",In=t(2730);function wn(n){var e=n.kanbanId,t=(0,i.useState)(""),r=(0,o.Z)(t,2),a=r[0],u=r[1],d=function(n){var e=(0,c.i)();return(0,l.useMutation)((function(n){return e("tasks",{data:n,method:"POST"})}),A(n))}(Zn()).mutateAsync,f=xn(),p=(0,i.useState)(!1),m=(0,o.Z)(p,2),h=m[0],j=m[1],v=function(){var n=(0,P.Z)((0,O.Z)().mark((function n(){return(0,O.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u(""),j(!1),n.next=4,d({projectId:f,name:a,kanbanId:e});case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),Z=function(){return j((function(n){return!n}))};return(0,i.useEffect)((function(){h||u("")}),[h]),h?(0,x.jsx)(In.Z,{children:(0,x.jsx)(s.Z,{onBlur:Z,placeholder:"\u9700\u8981\u505a\u4e9b\u4ec0\u4e48",autoFocus:!0,onPressEnter:v,value:a,onChange:function(n){return u(n.target.value)}},a)}):(0,x.jsx)("div",{onClick:Z,children:"+\u521b\u5efa\u4e8b\u7269"})}function Mn(n){var e=n.name,t=n.keyword;if(!t)return(0,x.jsx)(x.Fragment,{children:e});var r=e.split(t);return(0,x.jsx)(x.Fragment,{children:r.map((function(n,e){return(0,x.jsxs)("span",{children:[n,e===r.length-1?null:(0,x.jsx)("span",{style:{color:"#257AFD"},children:t})]},e)}))})}var Tn=["kanban"];function En(n){var e,t=n.id,r=gn().data,i=null===r||void 0===r||null===(e=r.find((function(n){return n.id===t})))||void 0===e?void 0:e.name;return i?(0,x.jsx)("img",{alt:"taskIcon",src:"task"===i?Ln:bn}):null}var On=function(n){var e=n.task,t=Cn().startEdit,r=vn().name;return(0,x.jsxs)(In.Z,{onClick:function(){return t(e.id)},style:{marginBottom:"0.5rem",cursor:"pointer"},children:[(0,x.jsx)("p",{children:(0,x.jsx)(Mn,{name:e.name,keyword:r})}),(0,x.jsx)(En,{id:e.typeId})]})},Pn=i.forwardRef((function(n,e){var t=n.kanban,r=(0,f.Z)(n,Tn),i=pn(vn()).data,o=null===i||void 0===i?void 0:i.filter((function(n){return n.kanbanId===t.id}));return(0,x.jsxs)(Nn,(0,a.Z)((0,a.Z)({},r),{},{ref:e,children:[(0,x.jsxs)(X.X2,{between:!0,children:[(0,x.jsx)("h3",{children:t.name}),(0,x.jsx)(Fn,{kanban:t},t.id)]}),(0,x.jsxs)(zn,{children:[null===o||void 0===o?void 0:o.map((function(n){return(0,x.jsx)(On,{task:n},n.id)})),(0,x.jsx)(wn,{kanbanId:t.id})]})]}))})),Fn=function(n){var e=n.kanban,t=function(n){var e=(0,c.i)();return(0,l.useMutation)((function(n){var t=n.id;return e("kanbans/".concat(t),{method:"DELETE"})}),N(n))}(jn()).mutateAsync,r=(0,x.jsx)(y.Z,{items:[{label:"\u5220\u9664",key:"\u5220\u9664",onClick:function(){g.Z.confirm({okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",title:"\u786e\u5b9a\u5220\u9664\u770b\u677f\u5417",onOk:function(){return t({id:e.id})}})}}]});return(0,x.jsx)(L.Z,{overlay:r,children:(0,x.jsx)(nn.Z,{type:"link",children:"..."})})},Nn=$.Z.div(yn||(yn=(0,r.Z)(["\n  min-width: 27rem;\n  border-radius: 6px;\n  background-color: rgb(244, 245, 247);\n  display: flex;\n  flex-direction: column;\n  padding: 0.7rem 0.7rem 1rem;\n  margin-right: 1.5rem;\n"]))),zn=$.Z.div(kn||(kn=(0,r.Z)(["\n  overflow: scroll;\n  flex: 1;\n\n  ::-webkit-scrollbar {\n    display: none;\n  }\n"])));function An(n){var e=gn().data;return(0,x.jsx)(h,(0,a.Z)({options:e||[]},n))}function Sn(){var n=vn(),e=q();return(0,x.jsxs)(X.X2,{marginBottom:4,gap:!0,children:[(0,x.jsx)(s.Z,{type:"text",style:{width:"20rem"},placeholder:"\u4efb\u52a1\u540d",value:n.name,onChange:function(n){return e({name:n.target.value})}}),(0,x.jsx)(v,{defaultOptionName:"\u7ecf\u529e\u4eba",value:n.processorId,onChange:function(n){return e({processorId:n})}}),(0,x.jsx)(An,{defaultOptionName:"\u7c7b\u578b",value:n.typeId,onChange:function(n){return e({typeId:n})}}),(0,x.jsx)(nn.Z,{onClick:function(){e({typeId:void 0,processorId:void 0,tagId:void 0,name:void 0})},children:"\u91cd\u7f6e"})]})}var Dn=t(7083);function Qn(){var n=(0,i.useState)(""),e=(0,o.Z)(n,2),t=e[0],r=e[1],a=xn(),u=function(n){var e=(0,c.i)();return(0,l.useMutation)((function(n){return e("kanbans",{data:n,method:"POST"})}),A(n))}(jn()).mutateAsync,d=function(){var n=(0,P.Z)((0,O.Z)().mark((function n(){return(0,O.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u({name:t,projectId:a});case 2:r("");case 3:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,x.jsx)(Nn,{children:(0,x.jsx)(s.Z,{size:"large",placeholder:"\u65b0\u5efa\u770b\u677f\u540d\u79f0",onPressEnter:d,value:t,onChange:function(n){return r(n.target.value)}})})}var Yn,Rn=t(4452),Xn={labelCol:{span:8},wrapperCol:{span:16}};function Bn(){var n=(0,Rn.Z)(),e=(0,o.Z)(n,1)[0],t=Cn(),r=t.editingTask,d=t.editingTaskId,f=t.close,p=function(n){var e=(0,c.i)();return(0,l.useMutation)((function(n){var t=n.id;return e("tasks/".concat(t),{method:"DELETE"})}),N(n))}(Zn()).mutate,m=function(n){var e=(0,c.i)();return(0,l.useMutation)((function(n){return e("Tasks/".concat(n.id),{data:n,method:"PATCH"})}),z(n))}(Zn()),h=m.mutateAsync,j=m.isLoading,Z=function(){var n=(0,P.Z)((0,O.Z)().mark((function n(){var t;return(0,O.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.getFieldValue(""),n.next=3,h((0,a.Z)((0,a.Z)({},r),t));case 3:f();case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,i.useEffect)((function(){e.setFieldsValue(r)}),[e,r]),(0,x.jsxs)(g.Z,{forceRender:!0,onCancel:function(){e.resetFields(),f()},onOk:Z,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",confirmLoading:j,title:"\u7f16\u8f91",open:!!d,children:[(0,x.jsxs)(u.Z,(0,a.Z)((0,a.Z)({},Xn),{},{initialValues:r,form:e,children:[(0,x.jsx)(u.Z.Item,{label:"\u4efb\u52a1\u540d",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4efb\u52a1\u540d"}],children:(0,x.jsx)(s.Z,{})}),(0,x.jsx)(u.Z.Item,{label:"\u7ecf\u529e\u4eba",name:"processorId",children:(0,x.jsx)(v,{defaultOptionName:"\u7ecf\u529e\u4eba"})}),(0,x.jsx)(u.Z.Item,{label:"\u4efb\u52a1\u540d",name:"typeId",children:(0,x.jsx)(An,{})})]})),(0,x.jsx)("div",{style:{textAlign:"right"},children:(0,x.jsx)(nn.Z,{onClick:function(){g.Z.confirm({okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",title:"\u786e\u5b9a\u5220\u9664\u4efb\u52a1\u5417",onOk:function(){return f(),p({id:Number(d)})}})},style:{fontSize:"14px"},size:"small",children:"\u5220\u9664"})})]})}function Wn(){(0,S.jr)("\u770b\u677f\u5217\u8868");var n=mn().data,e=function(n){var e=(0,c.i)();return(0,l.useQuery)(["kanbans",n],(function(){return e("kanbans",{data:n})}))}(hn()),t=e.data,r=e.isLoading,i=pn(vn()).isLoading,o=r||i;return(0,x.jsxs)(X.X_,{children:[(0,x.jsxs)("h1",{children:[null===n||void 0===n?void 0:n.name,"\u770b\u677f"]}),(0,x.jsx)(Sn,{}),o?(0,x.jsx)(Dn.Z,{size:"large"}):(0,x.jsxs)(Gn,{children:[null===t||void 0===t?void 0:t.map((function(n){return(0,x.jsx)(Pn,{kanban:n},n.id)})),(0,x.jsx)(Qn,{})]}),(0,x.jsx)(Bn,{})]})}var qn,Hn,Vn,Kn,Gn=(0,$.Z)("div")(Yn||(Yn=(0,r.Z)(["\n  display: flex;\n  overflow-x: scroll;\n  flex: 1;\n"]))),Un=t(2126),_n=function(){return{projectId:xn()}},Jn=function(){return["epics",_n()]},$n=t(8885),ne=function(n){var e=function(n){var e=(0,c.i)();return(0,l.useMutation)((function(n){return e("epics",{data:n,method:"POST"})}),A(n))}(Jn()),t=e.mutate,r=e.isLoading,d=e.error,f=u.Z.useForm(),p=(0,o.Z)(f,1)[0],m=xn(),h=function(){var e=(0,P.Z)((0,O.Z)().mark((function e(r){return(0,O.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t((0,a.Z)((0,a.Z)({},r),{},{projectId:m}));case 2:n.onClose();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,i.useEffect)((function(){p.resetFields()}),[p,n.visible]),(0,x.jsx)($n.Z,{open:n.visible,onClose:n.onClose,forceRender:!0,destroyOnClose:!0,width:"100%",children:(0,x.jsx)(ee,{children:r?(0,x.jsx)(Dn.Z,{size:"large"}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h1",{children:"\u521b\u5efa\u4efb\u52a1\u7ec4"}),(0,x.jsx)(X.Tv,{error:d}),(0,x.jsxs)(u.Z,{form:p,layout:"vertical",style:{width:"40rem"},onFinish:h,children:[(0,x.jsx)(u.Z.Item,{label:"\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4efb\u52a1\u7ec4\u540d"}],children:(0,x.jsx)(s.Z,{placeholder:"\u8bf7\u8f93\u5165\u4efb\u52a1\u7ec4\u540d\u79f0"})}),(0,x.jsx)(u.Z.Item,{style:{textAlign:"right"},children:(0,x.jsx)(nn.Z,{loading:r,type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})})]})]})})})},ee=$.Z.div(qn||(qn=(0,r.Z)(["\n  height: 80vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n"])));function te(){var n=mn().data,e=function(n){var e=(0,c.i)();return(0,l.useQuery)(["epics",n],(function(){return e("epics",{data:n})}))}(_n()).data,t=pn({projectId:null===n||void 0===n?void 0:n.id}).data,r=function(n){var e=(0,c.i)();return(0,l.useMutation)((function(n){var t=n.id;return e("epics/".concat(t),{method:"DELETE"})}),N(n))}(Jn()).mutate,a=(0,i.useState)(!1),u=(0,o.Z)(a,2),s=u[0],d=u[1];return(0,x.jsxs)(X.X_,{children:[(0,x.jsxs)(X.X2,{between:!0,children:[(0,x.jsxs)("h1",{children:[null===n||void 0===n?void 0:n.name,"\u4efb\u52a1\u7ec4"]}),(0,x.jsx)(nn.Z,{type:"link",onClick:function(){return d(!0)},children:"\u521b\u5efa\u4efb\u52a1\u7ec4"})]}),(0,x.jsx)(Un.ZP,{style:{overflow:"scroll"},dataSource:e,itemLayout:"vertical",renderItem:function(e){return(0,x.jsxs)(Un.ZP.Item,{children:[(0,x.jsx)(Un.ZP.Item.Meta,{title:(0,x.jsxs)(X.X2,{between:!0,children:[(0,x.jsx)("span",{children:e.name}),(0,x.jsx)(nn.Z,{onClick:function(){return function(n){g.Z.confirm({okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",title:"\u786e\u5b9a\u5220\u9664\u9879\u76ee\u7ec4\uff1a".concat(n.name),content:"\u70b9\u51fb\u786e\u5b9a\u5220\u9664",onOk:function(){r({id:n.id})}})}(e)},type:"link",children:"\u5220\u9664"})]}),description:(0,x.jsxs)("div",{children:[(0,x.jsxs)("div",{children:["\u5f00\u59cb\u65f6\u95f4:",b()(e.start).format("YYYY-MM-DD")]}),(0,x.jsxs)("div",{children:["\u7ed3\u675f\u65f6\u95f4:",b()(e.end).format("YYYY-MM-DD")]})]})}),(0,x.jsx)("div",{children:null===t||void 0===t?void 0:t.filter((function(n){return n.epicId===e.id})).map((function(e){return(0,x.jsx)(I.rU,{to:"/projects/".concat(null===n||void 0===n?void 0:n.id,"/kanban?editingTaskId=").concat(e.id),children:e.name},e.id)}))})]})},children:(0,x.jsx)(ne,{onClose:function(){return d(!1)},visible:s})})]})}function re(){var n=(0,fn.s0)(),e=function(){var n=(0,fn.TH)().pathname.split("/");return n[n.length-1]}();return(0,x.jsxs)(ue,{children:[(0,x.jsx)(oe,{children:(0,x.jsx)(y.Z,{defaultSelectedKeys:[e],onClick:function(e){var t=e.key;n(t)},mode:"inline",items:[{key:"kanban",label:"\u770b\u677f"},{key:"epic",label:"\u4efb\u52a1\u7ec4"}]})}),(0,x.jsx)(ae,{children:(0,x.jsxs)(fn.Z5,{children:[(0,x.jsx)(fn.AW,{path:"/kanban",element:(0,x.jsx)(Wn,{})}),(0,x.jsx)(fn.AW,{path:"/epic",element:(0,x.jsx)(te,{})}),(0,x.jsx)(fn.AW,{path:"/*",element:(0,x.jsx)(fn.Fg,{to:window.location.pathname+"/kanban",replace:!0})})]})})]})}var ie,oe=$.Z.aside(Hn||(Hn=(0,r.Z)(["\n  background-color: rgb(244, 245, 247);\n  display: flex;\n"]))),ae=$.Z.div(Vn||(Vn=(0,r.Z)(["\n  box-shadow: -5px 0 5px -5px rgba(0, 0, 0, 0.1);\n  display: flex;\n  overflow: hidden;\n"]))),ue=$.Z.div(Kn||(Kn=(0,r.Z)(["\n  display: grid;\n  grid-template-columns: 16rem 1fr;\n  width: 100%;\n"])));function se(){var n=K(),e=n.projectModalOpen,t=n.close,r=n.isLoading,c=n.editingProject,l=c?"\u7f16\u8f91\u9879\u76ee":"\u521b\u5efa\u9879\u76ee",d=(c?Q:Y)(V()),f=d.mutateAsync,p=d.error,m=d.isLoading,h=u.Z.useForm(),j=(0,o.Z)(h,1)[0],Z=function(){j.resetFields(),t()};return(0,i.useEffect)((function(){j.setFieldsValue(c)}),[c,j]),(0,x.jsx)($n.Z,{forceRender:!0,onClose:Z,open:e,width:"100%",children:(0,x.jsx)(le,{children:r?(0,x.jsx)(Dn.Z,{size:"large"}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h1",{children:l}),(0,x.jsx)(X.Tv,{error:p}),(0,x.jsxs)(u.Z,{form:j,layout:"vertical",style:{width:"40rem"},onFinish:function(n){f((0,a.Z)((0,a.Z)({},c),n)).then((function(){Z()}))},children:[(0,x.jsx)(u.Z.Item,{name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u9879\u76ee\u540d"}],label:"\u540d\u79f0",children:(0,x.jsx)(s.Z,{placeholder:"\u8bf7\u8f93\u5165\u9879\u76ee\u540d\u79f0"})}),(0,x.jsx)(u.Z.Item,{name:"organization",label:"\u90e8\u95e8",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u90e8\u95e8\u540d"}],children:(0,x.jsx)(s.Z,{placeholder:"\u8bf7\u8f93\u5165\u90e8\u95e8\u540d"})}),(0,x.jsx)(u.Z.Item,{name:"personId",label:"\u8d1f\u8d23\u4eba",children:(0,x.jsx)(v,{defaultOptionName:"\u8d1f\u8d23\u4eba"})}),(0,x.jsx)(u.Z.Item,{style:{textAlign:"right"},children:(0,x.jsx)(nn.Z,{loading:m,typeof:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})})]})]})})})}var ce,le=$.Z.div(ie||(ie=(0,r.Z)(["\n  height: 80vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n"]))),de=t(5485),fe=t(3020),pe=t(1333);function xe(){var n=D(),e=n.data,t=n.refetch,r=null===e||void 0===e?void 0:e.filter((function(n){return n.pin})),i=K().open,o=(0,x.jsxs)(he,{children:[(0,x.jsx)(de.Z.Text,{type:"secondary",children:"\u6536\u85cf\u9879\u76ee"}),(0,x.jsx)(Un.ZP,{children:null===r||void 0===r?void 0:r.map((function(n){return(0,x.jsx)(Un.ZP.Item,{children:(0,x.jsx)(Un.ZP.Item.Meta,{title:n.name})},n.id)}))}),(0,x.jsx)(pe.Z,{}),(0,x.jsx)(X.zL,{style:{border:0,color:"#0052cc"},onClick:i,children:"\u521b\u5efa\u9879\u76ee"})]});return(0,x.jsx)(fe.Z,{onOpenChange:function(){return t()},placement:"bottom",content:o,children:(0,x.jsx)("span",{children:"\u9879\u76ee"})})}var me,he=$.Z.div(ce||(ce=(0,r.Z)(["\n  min-width: 30rem;\n"])));function je(){var n=d(),e=n.data,t=n.refetch,r=(0,x.jsxs)(ye,{children:[(0,x.jsx)(de.Z.Text,{type:"secondary",children:"\u7ec4\u5458\u5217\u8868"}),(0,x.jsx)(Un.ZP,{children:null===e||void 0===e?void 0:e.map((function(n){return(0,x.jsx)(Un.ZP.Item,{children:(0,x.jsx)(Un.ZP.Item.Meta,{title:n.name})},n.id)}))}),(0,x.jsx)(pe.Z,{})]});return(0,x.jsx)(fe.Z,{onOpenChange:function(){return t()},placement:"bottom",content:r,children:(0,x.jsx)("span",{children:"\u7ec4\u5458"})})}var ve,Ze,Ce,ge,Le,ye=$.Z.div(me||(me=(0,r.Z)(["\n  min-width: 30rem;\n"])));function ke(){return(0,x.jsx)(we,{children:(0,x.jsxs)(I.VK,{children:[(0,x.jsx)(be,{}),(0,x.jsx)(Oe,{children:(0,x.jsxs)(fn.Z5,{children:[(0,x.jsx)(fn.AW,{path:"/",element:(0,x.jsx)(fn.Fg,{to:"/projects"})}),(0,x.jsx)(fn.AW,{path:"/projects",element:(0,x.jsx)(en,{})}),(0,x.jsx)(fn.AW,{path:"/projects/:projectId/*",element:(0,x.jsx)(re,{})})]})}),(0,x.jsx)(se,{})]})})}var be=function(){return(0,x.jsxs)(Me,{between:!0,children:[(0,x.jsxs)(Te,{gap:!0,children:[(0,x.jsx)(X.zL,{type:"link",onClick:S.Xj,children:(0,x.jsx)(dn,{width:"18rem",color:"rgb(38,132,255)"})}),(0,x.jsx)(xe,{}),(0,x.jsx)(je,{})]}),(0,x.jsx)(Ee,{children:(0,x.jsx)(Ie,{})})]})},Ie=function(){var n=(0,an.aC)(),e=n.logout,t=n.user;return(0,x.jsx)(L.Z,{overlay:(0,x.jsx)(y.Z,{items:[{label:"\u767b\u51fa",key:"logout",onClick:e}]}),children:(0,x.jsxs)(nn.Z,{type:"link",onClick:function(n){return n.preventDefault()},children:["Hi,",null===t||void 0===t?void 0:t.name]})})},we=$.Z.div(ve||(ve=(0,r.Z)(["\n  display: grid;\n  grid-template-rows: 6rem 1fr; //row \u5927\u5c0f\n  height: 100vh;\n"]))),Me=(0,$.Z)(X.X2)(Ze||(Ze=(0,r.Z)(["\n  padding: 3.2rem;\n  box-shadow: 0 0 5px 0 rgba(0, 0, 0, 0.1);\n  z-index: 1;\n"]))),Te=(0,$.Z)(X.X2)(Ce||(Ce=(0,r.Z)([""]))),Ee=$.Z.div(ge||(ge=(0,r.Z)([""]))),Oe=$.Z.main(Le||(Le=(0,r.Z)(["\n  display: flex;\n  overflow: hidden;\n"])))}}]);
//# sourceMappingURL=279.5b2cd059.chunk.js.map